
 
 
   
  巧用批处理快速切换IP地址           ★★★ 【字体：小 大】 
 
  
   
   
 巧用批处理快速切换IP地址 
 
作者：乔珊 文章来源：中国电脑教育报 点击数：1542 更新时间：2005-9-3 
 
 
　如果你的计算机同时连接着外网和内网，那么，你肯定会遇到需要经常切换动态IP地址和静态IP地址的烦恼。笔者就是这种情况，计算机通过ADSL连接外网，用的是自动分配IP地址的方式，同时也连接到内网，用的是固定IP地址，因此，经常需要在“本地连接”属性窗口中修改IP地址。每次都要通过“网上邻居→属性→本地连接→Internet协议→TCP/IP→属性”选择，然后点选所需要的IP地址格式，十分繁琐。那么，有没有更为简单的方法呢？经认真摸索，还真找到了便捷的方法，一起来看实现过程： 

　1. 创建切换由静态IP地址到动态IP地址的批处理文件 

　　打开记事本，录入以下内容： 

　　Echo off 

　　Netsh interface IP Set Address "本地连接" DHCP

　　Echo 已将IP地址由静态切换成动态，按任一键后，就可以使用外网了…… 

　　Pause 

　　录入完毕，经检查无误后，另存为“GoDHCPIP.bat”。文件名任取，好记就行，扩展名必须是“bat”。 

　　小提示：批处理文件中的“本地连接”是系统的默认网络连接名称，如果你曾经卸载并重装过网卡，那么这里有可能变成“本地连接２”、“本地连接３”等。批处理文件中的“本地连接”字样必须与桌面“网上邻居→属性”窗口中的网络连接图标名称相一致。另外，还要注意在“本地连接”和后面的数字之间有一个空格。 

　　2. 创建切换动态IP到静态IP的批处理文件 

　　打开记事本，录入以下内容： 

　　Echo off 

　　Netsh interface IP Set Address "本地连接" Static 192.168.xxx.xxx 255.255.255.0 

　　Echo 已将IP地址由动态切换成静态：192.168.xxx.xxx，按任一键后，就可以使用内网了…… 

　　Pause 

　　录入完毕，经检查无误后，另存为“GoStaticIP.bat”。 

　　小提示：批处理文件中的“本地连接”含义同上；“192.168.xxx.xxx”是你欲切换到的静态IP地址，请用你实际的IP地址替换。“255.255.255.0”是子网掩码。 

　　3. 使用 

　　当需要使用外网时，只需双击“GoDHCPIP.bat”批处理文件，按任一键后，就可以将IP地址由静态切换到动态，并且无需重新启动计算机，就可以开始使用外网了。 

　　当需要使用内网时，只需双击“GoStaticIP.bat”批处理文件，根据提示，按任一键后，就可以将IP地址由动态切换到静态固定IP地址了，并且无需重新启动计算机，就可以开始使用内网了。 

　　小提示：该方法适用于Windows 2000/XP/2003。另外，在Windows XP/2003操作系统中，通过“网上邻居”属性手动更改IP地址无需重启计算机，但在Windows 2000操作系统中，要使手动更改的IP生效，则必须重启计算机。而使用该方法则无需重启计算机，方便快捷。
 
 
 
 
 
 
